<!DOCTYPE html>
<html>
<head>
    <style type="text/css">
        body {
            font-family: Calibri;
            color: #000000;
            height: auto;
        }

        td {
            vertical-align: top;
            text-align: left;
        }

       /* @page {
            size: A4;
            margin-top: 2.2cm;
            margin-bottom: 2cm;
            margin-left: 0;
            margin-right: 0;
        }*/
        /*p {
            line-height: 0.4cm;
        }*/
    </style>
</head>
<body>

    <div class="container" ng-repeat="CofOrigin in CertifaciateOfPreInspectionList">
        <div>
            <table style="height:100%;width:100%;">
                <tr>
                    <td></td>
                    <td>

                        <div class=" hidden-print">
                            <div class="col-sm-7 col-md-9">

                            </div>
                            <div class="row">
                                <div class="col-sm-2 col-md-1">
                                    <button type="button" onclick="PrintPdf();" class="customBtn custmoBtnReset" style="border-radius: 3px; margin-bottom: -.9em; margin-top: -15px; padding-bottom: 3px; padding-top: 3px;" title="Print To .PDF">
                                        <i class="fa fa-print"></i>&nbsp;Print
                                    </button>
                                </div>

                                <div class="col-sm-3 col-md-2">
                                    <button type="button" onclick="ExportToDoc();" class="customBtn custmoBtnReset" style="border-radius: 3px; margin-bottom: -.9em; margin-top: -15px; padding-bottom: 3px; padding-top: 3px;" title="Export to .doc">
                                        <i class="fa fa-save"></i>&nbsp;Export to .doc
                                    </button>
                                </div>
                            </div>
                            <br />
                        </div>
                    </td>
                </tr>
            </table>
        </div>
        <!--<div>
            <p style="font-size: 25px; text-align: center; margin: 0px; padding: 0px;"><b><u>{{CofOrigin.CertificateName}}</u></b></p>
        </div>-->
        <table style="height:100%;width:100%;border:1px solid black" border="1">

            <tr>
                <td>
                    <p style="font-size:14px;margin-top:0px;margin-left:5px; ">
                        <b>1) Goods Consigned From (Exporter Businness Name, Address, Country)</b>
                    </p>
                    <p style="font-size:14px;margin-left:5px; line-height: 0.4cm" ng-if="CofOrigin.ExporterName"><b> {{CofOrigin.ExporterName}}</b> </p>
                    <p style="font-size:12px; word-spacing:2px;margin-left:5px; line-height: 0.4cm" ng-if="CofOrigin.ExproterFactoryAddress"><b>{{CofOrigin.ExproterFactoryAddress}}</b> </p>
                    <p style="font-size:12px; word-spacing:2px;margin-left:5px; line-height: 0.4cm" ng-if="CofOrigin.ExporterTIN"><b>TIN NO:{{CofOrigin.ExporterTIN}} , BIN:{{CofOrigin.ExporterBIN}}</b> </p>

                    <div style="border-bottom: 1px solid black;width:100%">
                    </div>

                    <p style="font-size:14px; font-weight:400;margin-left:5px; line-height: 0.4cm">
                        <b>2) Goods Consigned to (Consignee name ,Address, Country)</b>
                    </p>
                    <p style="font-size:12px;margin : 0;  padding : 0 ;word-spacing:2px;margin-left:5px; line-height: 0.4cm" ng-if="CofOrigin.ImporterName"><b>{{CofOrigin.ImporterName}}</b> </p>
                    <p style="font-size:12px;margin : 0;  padding : 0 ;word-spacing:2px;margin-left:5px; line-height: 0.4cm" ng-if="CofOrigin.ImporterDeleveryAddress"><b>{{CofOrigin.ImporterDeleveryAddress}}</b> </p>

                    <p style="font-size:12px;margin : 0;  padding : 0 ;word-spacing:2px;margin-left:5px; line-height: 0.4cm" ng-if="CofOrigin.ImporterTIN"><b>TIN No:</b>{{CofOrigin.ImporterTIN}}</p>
                    <p style="font-size:12px;margin : 0;  padding : 0 ;word-spacing:2px;margin-left:5px; line-height: 0.4cm" ng-if="CofOrigin.ImporterBIN"><b>BIN:</b>{{CofOrigin.ImporterBIN}} </p>
                </td>

                <td>
                    <p style="font-size:18px;text-align:center;font-weight: bold;vertical-align: bottom;" ng-if="CofOrigin.CertificateName">{{CofOrigin.CertificateName}}</p>
                    <p style="font-size:14px;text-align:center;font-weight:bold;">(NON PREFERENTAL)</p>
                    <p style="font-size:12px;text-align:center;font-weight: 100; line-height: 0.4cm">Combined Declaration and Certificate </p>
                    <p style="font-size:12px;text-align:center;">Issued by Bangladesh </p>
                    <div style="text-align:center;">

                        <img style="width:50px;height:50px;" src="/UploadedImages/rtlLogo.jpg" />

                    </div>

                    <p style="font-size:18px;margin : 0;  padding : 0 ;text-align:center;font-weight:bold; " ng-if="CofOrigin.ExporterName"><b>{{CofOrigin.ExporterName}}</b> </p>
                    <p style="font-size:12px; text-align:center;   margin : 0;  padding : 0 ;word-spacing:2px; line-height: 0.4cm" ng-if="CofOrigin.ExproterFactoryAddress"><b>{{CofOrigin.ExproterFactoryAddress}}</b> </p>
                    <!--<p style="font-size:14px; text-align:center;   margin : 0;  padding : 0 ;word-spacing:2px;"><b>Turag , Dhaka</b> </p>-->
                    <p style="font-size:12px; text-align:center;   margin : 0;  padding : 0 ; line-height: 0.4cm" ng-if="CofOrigin.ExporterEmail"><b>{{CofOrigin.ExporterEmail}}</b> </p>
                </td>
            </tr>
            <tr style="border-bottom:0px">
                <td style="width:50%; border:1px solid black; padding-top:0px; padding-bottom:0px; line-height: 0.4cm">
                    <p style="font-size:14px;">
                        <b style="margin-left:5px;">3) Means of transport and Route (as far as known)</b>
                    </p>
                    <p style="font-size:12px; margin-left:5px; margin-top:-5px; line-height: 0.4cm">Port of Loading - Beneficiary factory </p>
                    <p style="font-size:12px; margin-left:5px; margin-top:-5px; line-height: 0.4cm">Port of Discharge - Applicants factory </p>
                    <p ng-if="CofOrigin.CountryOfOrigin" style="font-size:12px; margin-left:5px;margin-top:-5px; line-height: 0.4cm">Final Destination - {{CofOrigin.CountryOfOrigin}}</p>
                </td>
                <td style="width:50%; border:1px solid black; padding: 5px; padding-top:0px; padding-bottom:0px; line-height: 0.4cm">
                    <div>
                        <p style="font-size:14px; font-weight:bold; line-height: 0.4cm">
                            4) For ofiicial Use
                        </p>
                    </div>

                </td>

            </tr>
            <tr style="border-top:0px">
                <td style="padding: 0px;border-right:0px; line-height: 0.4cm">
                    <table style="width:100%;height:100%;text-align:center; border-left: 0px solid;border-top: 0px solid;">
                        <thead>
                            <tr style="height:0px;">
                                <th style="text-align:center;padding-top:0 !important;border-left:0px solid;border-right:1px solid">
                                    <p style="margin-top:0px;">5.Item No</p>
                                </th>
                                <th style="text-align:center;padding-top:0 !important;border-left:1px solid;border-right:1px solid">
                                    <p style="margin-top:0px;">6. Mark and No Of packages</p>
                                </th>
                                <th style="text-align:center;padding-top:0 !important;border-left:0px solid;border-right:0px">
                                    <p style="margin-top:0px;">7. Number and Kinds of Packages Description of Goods</p>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="text-align:center;padding-top:0 !important;border-top:1px solid;border-bottom:1px solid">
                                    <p style="font-size:12px;">1</p>

                                </td>
                                <td style="text-align:justify;padding-top:0 !important;border:1px solid">

                                    <p style="font-size:14px;     margin-left:5px;  padding : 0 ;">Total Goods<b style="font-size:14px;" ng-if="CofOrigin.TotalGoods"><br />{{CofOrigin.TotalGoods}}</b> </p>
                                    <p style="font-size:14px;     margin-left:5px;  padding : 0 ;">Total Cartons:<b style="font-size:14px;" ng-if="CofOrigin.TotalCartons"><br /> {{CofOrigin.TotalCartons}}</b></p>
                                </td>
                                <td style="text-align:justify;padding-top:0 !important;border-top:1px solid;border-bottom:1px solid">
                                    <p style="font-size:12px;    margin-left:5px;  padding : 0 ;font-size:12px;"><b style="font-size:12px;font-weight:bold;" ng-if="CofOrigin.LcNo">LC NO: </b>{{CofOrigin.LcNo}} </p>
                                    <p style="font-size:12px;    margin-left:5px;  padding : 0 ;font-size:12px;">{{CofOrigin.LcDate}} </p>
                                    <p style="font-size:12px;    margin-left:5px;  padding : 0 ;font-size:12px;"><b style="font-size:12px;font-weight:bold;" ng-if="CofOrigin.ExpNo">EXP No: </b>{{CofOrigin.ExpNo}} </p>
                                    <p style="font-size:12px;    margin-left:5px;  padding : 0 ;font-size:12px;">{{CofOrigin.ExpDate}} </p>
                                    <p style="font-size:12px;    margin-left:5px;  padding : 0 ;font-size:12px;" ng-if="CofOrigin.ExpDate"><b>Bank Doc</b>{{CofOrigin.ExpDate}} </p>

                                    <p style="font-size:12px;    margin-left:5px;  padding : 0 ;font-size:12px;" ng-repeat="ciInfoDetail in CiInfoDetailReportList | filter: { InfoSubType: 'ExpContact' }" ng-if="ciInfoDetail.InfoLabel ||ciInfoDetail.InfoValue "> <b>{{ciInfoDetail.InfoLabel}} :</b> <br /> {{ciInfoDetail.InfoValue}}</p>

                                    <!--<p style="font-size: .9em; line-height: 1;    margin : 0;  padding : 0 ;" ng-if="ciInfoDetail.InfoValue"><u><b>{{ciInfoDetail.InfoLabel}}:</b></u><br /> {{ciInfoDetail.InfoValue}}</p>-->
                                    <p style="font-size:12px;    margin-left:5px;  padding : 0 ;font-size:12px;"><b style="font-size:12px;font-weight:bold;" ng-if="CofOrigin.HSCode">HS Code: </b>{{CofOrigin.HSCode}} </p>
                                    <p style="font-size:12px;    margin-left:5px;  padding : 0 ;font-size:12px;"><b style="font-size:12px;font-weight:bold;" ng-if="CofOrigin.IRC">IRC No: </b>{{CofOrigin.IRC}} </p>
                                    <p style="font-size:12px;    margin-left:5px;  padding : 0 ;font-size:12px;"><b style="font-size:12px;font-weight:bold;" ng-if="CofOrigin.IRC">E-IRC No: </b>{{CofOrigin.IRC}} </p>
                                    <p style="font-size:12px;    margin-left:5px;  padding : 0 ;font-size:12px;"><b style="font-size:12px;font-weight:bold;" ng-if="CofOrigin.Lca">LCAF No: </b>{{CofOrigin.Lca}} </p>
                                </td>

                            </tr>

                            <tr style="text-align:justify;">

                                <td colspan="3">
                                    <p style="margin-left:5px;"> Packing In Standard Export Cartons.</p>
                                    <p style="font-size:14px;font-weight:bold;text-align:justify;margin-left:5px;" ng-if="CofOrigin.CartonMeasurement"> <u>Carton Measurment:</u>{{CofOrigin.CartonMeasurement}}</p>
                                </td>
                            </tr>
                        </tbody>

                    </table>
                </td>
                <td style=" line-height: 0.4cm">
                    <table style="width:100%;height:100%;border-left: 0px solid;border-top: 0px solid;">
                        <thead>
                            <tr style="height:0px;">
                                <th style="text-align:center;padding-top:0 !important;border-left:0px solid;border-right:0px solid">

                                    <p style="margin-top:0px;">8. Origin Criteria</p>
                                </th>
                                <th style="text-align:center;padding-top:0 !important;border-left:1px solid;border-right:1px solid">

                                    <p style="margin-top:0px;">9. Gross Weight</p>
                                </th>
                                <th style="text-align:center;padding-top:0 !important;border-left:1px solid;border-right:0px solid">

                                    <p style="margin-top:0px;">10. No And Date Of Invoice</p>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="text-align:center;">
                                <td style="text-align:center;padding-top:0 !important;border-top:1px solid;border-bottom:1px solid">
                                    <p style="font-size:14px;   padding : 0 ;font-size:12px;" ng-if="CofOrigin.CountryOfOrigin">{{CofOrigin.CountryOfOrigin}} </p>

                                </td>
                                <td style="padding-top:0 !important;border:1px solid;width:170px;">
                                    <p style="font-size:12px;    margin-left:5px;  padding : 0 ;font-size:12px;"><b style="font-size:12px;" ng-if="CofOrigin.LabelNetWeight">Label Net Weight </b><br /> {{CofOrigin.LabelNetWeight}}</p>
                                    <p style="font-size:12px;    margin-left:5px;  padding : 0 ;font-size:12px;"><b style="font-size:12px;" ng-if="CofOrigin.LabelGrossWeight">Label Gross Weight</b><br />{{CofOrigin.LabelGrossWeight}} </p>
                                    <p style="font-size:12px;    margin-left:5px;  padding : 0 ;font-size:12px;"><b style="font-size:12px;">Ribbon Net Weight</b><br />{{CofOrigin.RibbonNetWeight}}</p>
                                    <p style="font-size:12px;    margin-left:5px;  padding : 0 ;font-size:12px;"><b style="font-size:12px;" ng-if="CofOrigin.RibbonGrossWeight">Ribbon Gross Weight</b><br />{{CofOrigin.RibbonGrossWeight}}</p>
                                </td>
                                <td style="padding-top:0 !important;border-top:1px solid;border-bottom:1px solid">
                                    <p style="font-size:12px;    margin-left:5px;  padding : 0 ;font-size:12px;" ng-if="CofOrigin.PINo"><b>PI Ref No</b><br /> {{CofOrigin.PINo}}</p>
                                    <p style="font-size:12px;    margin-left:5px;  padding : 0 ;font-size:12px;" ng-if="CofOrigin.PIDate">Date: {{CofOrigin.PIDate}}</p>
                                </td>

                            </tr>

                        </tbody>

                    </table>
                </td>
            </tr>
            <tr>
                <td style="width:50%; padding: 5px; padding-top:0px; padding-bottom:0px;">

                    <p style="font-size:12px;">11. Certificatation</p>
                    <p style="font-size:12px;">It is here by certifying that /on the basis of above mentioned information is correct.</p>
                    <div style="height:100px;width:100%;">
                    </div>

                </td>
                <td style="width:50%; border:1px solid black; padding: 5px; padding-top:0px; padding-bottom:0px;">
                    <div>
                        <p style="font-size:12px;">
                            12. <b>Declaration by the exporter</b>

                        </p>
                        <p style="font-size:14px;">
                            The under signing here by declare that,above details and the statement are correct that all the goods were produce and that they comply with the origin reguerments for export.
                        </p>

                    </div>

                    <div style="height:100px;width:100%;">

                    </div>

                    <div>
                        <p style="text-align:center;font-size:14px;font-weight:400">Place date and signature of authorized signatories</p>
                    </div>

                </td>

            </tr>


        </table>


    </div>




    <script type="text/javascript">
        $('#HtmlData').hide();
        function unMerged() {

            $temp = $("#ciTable td[rowspan]");

            $temp.each(function () {
                $(this).removeAttr("rowspan");
            });

            $("#ciTable td:hidden").show();

            $("#ciTable td").css("background-color", "");
            $("#ciTable tr:not(:has(th))").css("background-color", "#FFFFFF");
            $("#ciTable tr:not(:has(th)):odd").css("background-color", "#FFFFFF");
            $("#ciTable thead tr").each(function () {
                $("th").show();
            });

            $("#ciTable tbody tr").each(function () {
                $("td").show();
            }
            );

            var isRemoved = false;
        }

        function ExportToDoc() {
            unMerged();
            //$('#ciTable tbody tr th:nth-last-child(1)').each(function (tdIndex, tr) {
            //    $("#ciTable tbody tr th:nth-last-child(1)").find("span").remove();
            //})

            //$('#ciTable tbody tr td:nth-last-child(-n+2)').each(function (tdIndex, tr) {
            //    $("#ciTable tbody tr td:nth-last-child(-n+2)").find("span").remove();
            //})
            $('.hideButton').hide();
            $('#result').hide();

            //$("#ci tbody tr td").find("textarea").each(function (areaIndex, area) {
            //    $(this).replaceWith("<div id='txtAreaInfo'>" + $(this).text() + "</div>");

            //});

            var sourceHTML = document.getElementById("source-html").innerHTML;

            // console.log(sourceHTML);
            function escapeRegExp(string) {
                return string.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
            }
            function replaceAll(str, term, replacement) {
                return str.replace(new RegExp(escapeRegExp(term), 'g'), replacement);
            }
            var removeTableBorderStr;
            $('#ciTable tbody tr td').each(function (tdIndex, td) {
                var preStyle = $(this).attr("style");

                if (preStyle != undefined) {
                    var pos = preStyle.indexOf("display: none;");
                    if (pos != -1) {
                        $('#ciTable').find("tbody tr td:nth-child(" + tdIndex + ")").each(function () {

                            $(this).remove();

                            alert();
                        });
                        //  $(this).remove();
                    }
                }

            });


            var thCount = 8;
            //$('#ciTable thead tr th').each(function () {
            //    thCount++;
            //});

            if (thCount <= 10 && thCount > 0) {
                removeTableBorderStr = replaceAll(sourceHTML, 'style="width: 100% !important; font-size: .9em; font-family: Calibri; color:#000000; text-align:center; margin:0; padding:0;', 'style="width: 100% !important; text:align:center; border: 1px solid black; border-collapse: collapse; font-size: .9em; font-family: Calibri; color:#000000; margin:0; padding:0;');
            }
            else if (thCount <= 15 && thCount > 10) {
                removeTableBorderStr = replaceAll(sourceHTML, 'style="width: 100% !important; font-size: .9em; font-family: Calibri; color:#000000; text-align:center; margin:0; padding:0;', 'style="width: 100% !important; text:align:center; border: 1px solid black; border-collapse: collapse; font-size: .7em; font-family: Calibri; color:#000000; margin:0; padding:0;');
            }
            else {
                alert('Please insert less then 15 column.');
                return;
            }

            //var firstChildCount = 1;
            //$("#ciTable tbody tr").each(function () {
            //    var firstChild = $(this).children(':first');
            //    firstChild.text(firstChildCount++).outerText;
            //});
            var source = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(removeTableBorderStr);
            var fileDownload = document.createElement("a");
            document.body.appendChild(fileDownload);
            fileDownload.href = source;
            fileDownload.download = 'Commercil Invoice.doc';
            fileDownload.click();
            document.body.removeChild(fileDownload);
            $('.hideButton').show();
            $('#result').show();
            //$("#ci tbody tr td").find("textarea").show();
            //$("#ci tbody tr td").html(CommercialInvoiceMasterList[0].ExporterInfo);
            //$("#ci tbody tr td").find("#ExInfo").each(function () {
            //    $(this).replaceWith("<textarea>" + CommercialInvoiceMasterList[0].ExporterInfo + "</textarea>");
            //});

            //$("#ci tbody tr td").find("div").each(function (divsIndex, divs) {
            //    $(this).replaceWith("<textarea id='txtAreaInfo' spellcheck='false'>" + $(this).text() + "</textarea>");
            //});

        }


        function PrintPdf() {

            window.print();

        }
        jQuery(document).ready(function ($) {

            $(".main-sidebar").attr("hidden", true);
            $(".main-header").attr("hidden", true);
            $(".main-footer").attr("hidden", true);
            $("#br").attr("hidden", true);

            $("div").removeClass("wrapper");
            $("div").removeClass("content-wrapper");
        });


    </script>

</body>
</html>
